import{d as e,l as a,r as t,h as s,a as l,o as n,u as r,s as i,w as o,b as c,q as u,t as m,j as d,F as v,z as p,m as g}from"./chunk-Bmj9xSPk.js";import{u as f}from"./chunk-BengT3oa.js";import{a as b}from"./chunk-Dv7RK_ed.js";const h=["src"],I=e({__name:"index",props:{imgItem:{type:Object,default:()=>({})}},setup(e){const r=e,i=a.createInstance({name:"imgStore"}),o=t("");return s(async()=>{const e=await async function(e){let a="";if("Storage"===e.url){const t=e.id;a=await i.getItem(t)}else a=e.url;return a}(r.imgItem);o.value=e}),(e,a)=>(n(),l("img",{src:o.value,alt:"Image",class:"object-cover h-full rounded-xl"},null,8,h))}}),y={class:"toast toast-top toast-end"},k={key:0,class:"alert alert-error"},w={key:1,class:"alert alert-success"},x={key:2,class:"alert alert-error"},S={class:""},j={for:"explore"},C=["accept"],_={class:"btn btn-primary btn-sm"},q={class:"p-0"},F={class:"flex items-center gap-8"},T={class:"avatar h-14"},$={class:"w-12 h-12 mask mask-squircle hover:w-14 hover:h-14"},z={class:"w-64"},D={class:"overflow-hidden font-bold whitespace-nowrap text-ellipsis"},L=["onClick"],N=e({__name:"ImageConfig",setup(e){const{t:h}=r(),N=f().globalConfig,{getImageList:O}=i(N),U=t("image/*"),A=t(0),B=a.createInstance({name:"imgStore"});async function E(e){if(!/image*/.test(e.target.files[0].type))return void(A.value=3);const{dataUrl:a,fileName:t}=await b(e.target.files[0]),s=`${(new Date).getTime().toString()}+${t}`;B.setItem(s,a).then(()=>{N.addImage({id:s,name:t,url:"Storage"}),A.value=1}).catch(()=>{A.value=2})}return s(()=>{}),o(()=>A.value,e=>{0!==e&&setTimeout(()=>{A.value=0},2e3)}),(e,a)=>(n(),l(v,null,[c("div",y,[2===A.value?(n(),l("div",k,[c("span",null,m(d(h)("error.uploadFail")),1)])):u("",!0),1===A.value?(n(),l("div",w,[c("span",null,m(d(h)("error.uploadSuccess")),1)])):u("",!0),3===A.value?(n(),l("div",x,[c("span",null,m(d(h)("error.notImage")),1)])):u("",!0)]),c("div",null,[c("div",S,[c("label",j,[c("input",{id:"explore",type:"file",class:"",style:{display:"none"},accept:U.value,onChange:E},null,40,C),c("span",_,m(d(h)("button.upload")),1)])]),c("ul",q,[(n(!0),l(v,null,p(d(O),e=>(n(),l("li",{key:e.id,class:"mb-3"},[c("div",F,[c("div",T,[c("div",$,[g(I,{"img-item":e},null,8,["img-item"])])]),c("div",z,[c("div",D,m(e.name),1)]),c("div",null,[c("button",{class:"btn btn-error btn-xs",onClick:a=>function(e){"Storage"===e.url&&B.removeItem(e.id).then(()=>{N.removeImage(e.id)}),N.removeImage(e.id)}(e)},m(d(h)("button.delete")),9,L)])])]))),128))])])],64))}});export{N as default};
