import{l as e}from"./chunk-BcwQrg-K.js";import{a6 as a,r as t,o as s,W as l,aS as r,w as n,X as o,U as i,bg as c,u,F as m,b0 as p,a3 as d}from"./chunk-CuUUEVgY.js";import{u as g}from"./chunk-Dal6fL2O.js";import{a as v}from"./chunk-Dv7RK_ed.js";import{s as h}from"./chunk-vv8T6d3M.js";import{u as k}from"./chunk-CIRXpJyU.js";import"./chunk-T1cRhSFL.js";import"./chunk-CZH_E4qY.js";import"./chunk-jVKjNuRY.js";import"./chunk-BYM7fZuu.js";import"./chunk-DUzMzk5W.js";import"./chunk-DOLF-9o1.js";import"./chunk-CwkjfrOa.js";import"./chunk-rd0oqKqK.js";import"./chunk-ChzSki6g.js";import"./chunk-DHt_odDz.js";import"./chunk-Dcea1vLA.js";const f=["src"],j=a({__name:"index",props:{imgItem:{type:Object,default:()=>({})}},setup(a){const n=a,o=e.createInstance({name:"imgStore"}),i=t("");return s(async()=>{const e=await async function(e){let a="";if("Storage"===e.url){const t=e.id;a=await o.getItem(t)}else a=e.url;return a}(n.imgItem);i.value=e}),(e,a)=>(r(),l("img",{src:i.value,alt:"Image",class:"object-cover h-full rounded-xl"},null,8,f))}}),b={class:"toast toast-top toast-end"},I={key:0,class:"alert alert-error"},y={key:1,class:"alert alert-success"},w={key:2,class:"alert alert-error"},x={class:""},S={for:"explore"},C=["accept"],_={class:"btn btn-primary btn-sm"},F={class:"p-0"},T={class:"flex items-center gap-8"},U={class:"avatar h-14"},$={class:"w-12 h-12 mask mask-squircle hover:w-14 hover:h-14"},q={class:"w-64"},B={class:"overflow-hidden font-bold whitespace-nowrap text-ellipsis"},D=["onClick"],L=a({__name:"ImageConfig",setup(a){const{t:f}=k(),L=g().globalConfig,{getImageList:N}=h(L),O=t("image/*"),W=t(0),X=e.createInstance({name:"imgStore"});async function z(e){if(!/image*/.test(e.target.files[0].type))return void(W.value=3);const{dataUrl:a,fileName:t}=await v(e.target.files[0]),s=`${(new Date).getTime().toString()}+${t}`;X.setItem(s,a).then(()=>{L.addImage({id:s,name:t,url:"Storage"}),W.value=1}).catch(()=>{W.value=2})}return s(()=>{}),n(()=>W.value,e=>{0!==e&&setTimeout(()=>{W.value=0},2e3)}),(e,a)=>(r(),l(m,null,[o("div",b,[2===W.value?(r(),l("div",I,[o("span",null,c(u(f)("error.uploadFail")),1)])):i("",!0),1===W.value?(r(),l("div",y,[o("span",null,c(u(f)("error.uploadSuccess")),1)])):i("",!0),3===W.value?(r(),l("div",w,[o("span",null,c(u(f)("error.notImage")),1)])):i("",!0)]),o("div",null,[o("div",x,[o("label",S,[o("input",{id:"explore",type:"file",class:"",style:{display:"none"},accept:O.value,onChange:z},null,40,C),o("span",_,c(u(f)("button.upload")),1)])]),o("ul",F,[(r(!0),l(m,null,p(u(N),e=>(r(),l("li",{key:e.id,class:"mb-3"},[o("div",T,[o("div",U,[o("div",$,[d(j,{"img-item":e},null,8,["img-item"])])]),o("div",q,[o("div",B,c(e.name),1)]),o("div",null,[o("button",{class:"btn btn-error btn-xs",onClick:a=>function(e){"Storage"===e.url&&X.removeItem(e.id).then(()=>{L.removeImage(e.id)}),L.removeImage(e.id)}(e)},c(u(f)("button.delete")),9,D)])])]))),128))])])],64))}});export{L as default};
